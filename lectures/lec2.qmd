---
title: Algebraic and Semi-Algebraic Reasoning For Formal Methods
subtitle: Lecture 2 -  Ideals, Varieties and Groebner Bases
author: Sriram Sankaranarayanan
format:
  revealjs:
    theme: serif
    center: true
    transition: slide
    incremental: false
    slide-number: c/t
    pdf-separate-fragments: true
    html-math-method:
        method: mathjax

---
## Git Repo

<https://github.com/sriram0339/madrid_july_2025.git>

## Book 

![](figures/ideals_varieties_algorithms.webp){width=30% fig-align="center"}


## Introduction 

- System of polynomial equations: $p_i \in R[x_1, \ldots, x_n]$:
 $$ p_1 = 0\ \land\ p_2 = 0 \ \land\ \cdots \ \land p_m = 0 $$ 

:::{.fragment}

- __Question 1:__  Check entailment.
$$ p_1 = 0 \ \land\ \cdots \ \land p_m  = 0 \ \models\ p = 0 $$

- __Question 2:__ Quantifier elimination.
$$ (\exists x_i)\ p_1 = 0\ \land\ p_2 = 0 \ \land\ \cdots \ \land p_m = 0 $$

- _Other Questions:_ That we do not yet know to ask!! 

:::


## Polynomial Ideals 

<font color="red">Ideal</font> is a __set of polynomials__: $I \subseteq R[x_1, \ldots, x_n]$.

 - Closed under addition: $p_1, p_2 \in I\ \Rightarrow\ p_1 + p_2 \in I$.

 - Closed under multiplication by any polynomial: $p \in I, q \in R[\vec{x}]\ \Rightarrow\ p \cdot q \in I$.

:::{.fragment}

- __Ideal Generated by a Set of Polynomials:__

$$\left\langle p_1, \ldots, p_k\right\rangle  = \{ p_1 \lambda_1 + \cdots + p_k \lambda_k\ |\ \lambda_i \in R[\vec{x}] \}$$

:::


## Polynomial Ideals (Example)

Consider: 
$$ I = \left\langle p_1:\ x_1 - x_2, p_2: x_1^2 \right\rangle $$ 


<font color="red"> Exercise </font>  

> Write down: 
>
>  - A few polynomials that belong to this ideal and
>  - A few that do not. 

## Algebraic Variety 
$$\newcommand\Var{\mathsf{Var}}
\newcommand\Id{\mathsf{Id}}$$

- $L \subseteq R[x_1, \ldots, x_n]$

- Variety $\Var(L) \subseteq R^n$
$$\Var(L)= \{ (x_1, \ldots, x_n)\ |\ \forall\ p \in L,\ p(x_1, \ldots, x_n) = 0 \}$$

:::{.fragment}

Eg.,  Let $L = \{ p_1, p_2 \} \subseteq \mathbb{R}[x_1, x_2]$:

$$\Var(I) = \{ (x_1, x_2) \in \mathbb{R}^2\ |\  p_1(x_1, x_2) = p_2(x_1, x_2) = 0 \,.\}$$

:::

## Variety (Examples)

:::{.fragment}
Intersection of two circles: 
$$\{ (x_1, x_2)\ |\ (x_1^2 + x_2^2 = 5) \ \land\ (x_1 -1)^2 + (x_2 -1)^2 = 4 \}$$
:::

:::{.fragment}
All rank $1$ $n\times n$ matrices:
$$\{ A \in \mathbb{R}^{n\times n}\ |\ \mathsf{rank}(A) = 1 \}$$
:::

:::{.fragment}
Set of all $n \times n$ matrices $G$ such that $\mathsf{det}(G) = 1$. 

 - Also called "Special Linear Group" $\text{SL}_n$.
:::

## Ideal and Varieties Relation
- Let us fix an algebraically closed field $K$.
  - Polynomial ring $K[x_1, \ldots, x_n]$
- Let $L \subseteq K[\vec{x}]$. 
$$ \Var(L) = \{ \vec{x} \in K^n\ |\ \forall\ p \in L,\ p(\vec{x}) = 0 \}\,.$$ 

:::{.fragment}
- Let $S \subseteq K^n$.
- $\Id(S) = \{ p \in K[x_1, \ldots, x_n]\ |\ \forall \vec{y} \in S, p(\vec{y}) = 0\}\,.$

:::

:::{.fragment}
- $\Var(\Id(S))$ is the smallest variety $V$ containing $S$. 

- $\Id(\Var(J))$ is  called the _radical ideal_ of $J$.

:::


## Example

::::{.columns}
:::{.column width="50%"}
![](figures/Quarter_circle.png){width="100%"}

$$ S = \left\{ (x, y)\ |\ \begin{array}{c}
x = \cos(\theta), \\ 
y = \sin(\theta), \\ 
\theta \in [\frac{\pi}{4},  \frac{3\pi}{4}]
\end{array}  \right\} \,.$$
:::
:::{.column width="50%"}

$$\Id(S) = \langle x^2 + y^2 - 1 \rangle $$

$$\Var(\Id(S)) = \{ (x, y)\ |\ x^2 + y^2 = 1 \}$$
:::
::::

## Galois Connection 

:::{.incremental}
 - Lattice of ideals: $(\mathcal{I}, \subseteq)$.
 - Lattice of varieties: $(\mathcal{V}, \subseteq)$.
 - $\Var: \mathcal{I} \to \mathcal{V}$, and $\Id: \mathcal{V} \to \mathcal{I}$.
 - Galois connection: $J \in \mathcal{I},\ V \in \mathcal{V}$.
   $$ \begin{array}{c}
   J \subseteq \Id(V) \ \Leftrightarrow\ V \subseteq \Var(J)
   \end{array} $$ 
:::

## Ideal : Properties 

:::{.incremental}

 - The intersection of two ideals is an ideal. 

 - The union of two ideals is an ideal?
   - Define the ``smallest''' ideal containing the union. 

 - Let $I \subseteq R[x_1, \ldots, x_n, y]$ be an ideal.
   - $\mathsf{proj}(I; x_1, \ldots, x_n) =  I \cap R[x_1, \ldots, x_n]$ is an ideal over $x_1, \ldots, x_n$.

 - If $1 \in I$ then $I = R[x_1, \ldots, x_n]$.

 - Any ideal $I \subseteq R[x]$ has the form $I = \langle p(x) \rangle$.

:::

## Varieties: Closure Properties


:::{.incremental}

 - Unions/Intersections of finitely many algebraic varieties is an algebraic variety.

 - Projection of an algebraic variety over a subset of variables is an algebraic variety?
   - Consider the projection of $\{ (x, y)\ |\ xy = 1\}$.

 - Exercise: Characterize all subsets of the real line $\mathbb{R}$ that are algebraic varieties. 
:::


## Ideal Generated by Assertion 

__Assertion:__  $p_1 = 0 \land p_2 = 0 \land \cdots \land p_k = 0$.

- __Ideal Generated by the Assertion:__
$$ I = \langle p_1, \ldots, p_k \rangle = \{ p_1 \lambda_1 + \cdots + p_k \lambda_k\ |\ \lambda_i \in R[\vec{x}] \} $$

:::{.fragment .incremental}

__Ideal membership and entailment?__

- __(A):__ $p_1 = 0\ \land\ p_2 = 0\ \land\ \cdots \land\ p_k = 0  \ \models\ p = 0$
- __(B):__ $p \in \left\langle p_1, \ldots, p_k \right\rangle$

- What (if any) is the connection between __(A)__ and __(B)__?

:::


## Polynomial Ideals and Entailment 

- __Lemma:__ If $p \in \left\langle p_1, \ldots, p_k \right\rangle$, then 
$$ (p_1 = 0 \land p_2 = 0 \land \cdots \land p_k = 0) \models p = 0 $$
- __Proof:__ 
  - $p = p_1 \lambda_1 + \cdots + p_k \lambda_k$.
  - If $p_1 = 0, \ldots, p_k = 0$, then $p = \sum_{i=1}^k \lambda_i p_i = 0$.

### Questions: 
 - Does the converse hold? 
 - How do we check $p \in I$? 

 

## Converse 

- If $(p_1 = 0 \land p_2 = 0 \land \cdots \land p_k = 0) \models p = 0$ then $p \in I$? 

- <font color="red"> In general, No! </font> 

:::{.fragment}
- __Problem \# 1__: Problem with "powers"
$$ (\forall x, y \in \mathbb{R}^2), (x^2 + y^2 - 1 = 0 \ \land\ y = 1) \models x = 0 $$ 
$$ x \not\in \left\langle x^2 + y^2 - 1, y - 1 \right\rangle \leftarrow\ \text{why?}$$
::: 

:::{.fragment}
- __Problem \# 2__: Algebraic Closure. 
$$ (\forall x, y \in \mathbb{R}^2)\ \; ( 1 + x^2 = 0) \ \Rightarrow\  x^2 - y^2 + 2 y + x - 7 = 0\,. $$
:::
 

## Hilbert's Nullstellensatz

Hilbert, David (1893). "Ueber die vollen Invariantensysteme". Mathematische Annalen. 42 (3): 313â€“373.

- __Hilbert's Nullstellensatz:__ Consider $p_1, \ldots, p_m \in k[x_1, \ldots, x_n]$ and let $K$ be the algebraic closure of $k$. The following are equivalent:

$$ \mathbf{(A):}\  (\forall \vec{x} \in K^n)\; (p_1 = 0 \ \land\ \cdots \land\ p_m = 0) \ \Rightarrow\ p = 0 $$ 

$$ \mathbf{(B):}\  p^r \in \left\langle p_1, \ldots, p_m \right\rangle \ \text{for some}\ r \in \mathbb{N} $$ 

 

## Example - 1

$$ (\forall x, y \in \mathbb{R}^2), (x^2 + y^2 - 1 = 0 \ \land\ y = 1) \models x = 0 $$ 

$$ x \not\in \langle x^2 + y^2 - 1, y - 1 \rangle $$

However, 

$$ x^2 \in \langle x^2 + y^2 - 1, y - 1 \rangle  $$ 

$$ x^2 = 1 \times (x^2  +y ^2 - 1) - (y + 1) \times (y -1 )$$ 

 
## Example - 2

For any polynomial p, the following entailment holds over $(x,y) \in \mathbb{R}^2$:
$$  ( x^2 + 1 = 0) \ \models p(x, y) = 0 $$ 

However, $I = \langle x^2 + 1 \rangle \not= \mathbb{R}[x,y]$. 

:::{.fragment}
- $\mathbb{R}$ is not algebraically closed.
- If $x, y \in \mathbb{C}^2$, we have $$ x^2 + 1 = 0,\ \Rightarrow\ x = \pm i $$ 


:::
 

## Coefficient Field

The field matters!!

 
:::{.fragment .incremental}

- Take $n = 11$, do these entailments hold over $\mathbb{Q}$:
$$ x^n + y^n = 1 \models (xy = 0\ \land\ x + y = 1) ?$$

- Yes! Cf. [Andrew Wiles, Annals of Mathematics,  1995].
:::

## Algebraic Reasoning 

$$ p_1 = 0 \land\ p_2 = 0 \land \cdots \land p_k = 0 \models p = 0 $$

- Form the ideal $I = \langle p_1, \ldots, p_k\rangle$.


- Test if $p \in I$ or $p^2 \in I$, ...

  - How do we test $p \in I$ in the first place?
  
  - How many powers of $p$ should we test?

## Plan for Today

  - Algorithm for testing ideal membership. 
    - Using a term rewriting system.
  - Preliminaries: 
    - Monomial ordering and polynomial reminder. 
  - Groebner basis 
  - Ideal-Variety Correspondence. 

## Ideal Membership 

Consider a polynomial ideal. 

$$ I = \left\langle x - y, y^2 - 1  \right\rangle  $$ 

Does $x^2 - 1 \in I$ ?

:::{.fragment}
  - Si! 
  $$ x^2 - 1 =  (x + y ) \times (x  - y) + 1 \times (y^2 - 1) \,.$$
:::



:::{.fragment}
$x^2 \in I$?

  - No. 
:::